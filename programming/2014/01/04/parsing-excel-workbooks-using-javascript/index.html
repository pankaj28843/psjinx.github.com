<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Parsing excel workbooks using Javascript - psjinx's blog</title>

    <!-- for Google -->
    <meta description="A Javascript library for parsing .xlsx files. It includes sample code along with demo for integration with AngularJS. Use cases include listing sheet names for selection in a form, showing preview of selected sheet etc. ">
    <meta name="keywords" content='psjinx, pankaj singh, iit kharagpur, django, javascript, xamcheck, policy innovations, freelancer'>
    <meta name="author" content="Pankaj Singh">

    <!-- for Facebook -->
    <meta property="og:title" content="Parsing excel workbooks using Javascript - psjinx's blog" />
    <meta property="og:image" content="https://gravatar.com/avatar/d36fdce04734c18be6c97814ded214c2" />
    <meta property="og:url" content="http://psjinx.com/" />
    <meta property="og:description" content="A Javascript library for parsing .xlsx files. It includes sample code along with demo for integration with AngularJS. Use cases include listing sheet names for selection in a form, showing preview of selected sheet etc. " />

    <!-- for Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Parsing excel workbooks using Javascript - psjinx's blog" />
    <meta name="twitter:description" content="A Javascript library for parsing .xlsx files. It includes sample code along with demo for integration with AngularJS. Use cases include listing sheet names for selection in a form, showing preview of selected sheet etc. " />
    <meta name="twitter:image" content="https://gravatar.com/avatar/d36fdce04734c18be6c97814ded214c2" />

    <!-- Favicon -->
    <link href="http://psjinx.com/favicon.ico" rel="shortcut icon" />

    <!--Stylesheets-->

    <link rel="stylesheet" href="http://psjinx.com/css/app.css" />
    <script src="http://psjinx.com/bower_components/modernizr/modernizr.js"></script>
    <link rel="stylesheet" media="screen" type="text/css" href="http://psjinx.com/css/syntax.css" />
    <link rel="stylesheet" media="screen" type="text/css" href="http://psjinx.com/fonts/foundation-icons/foundation-icons.css" />

    <!--Atom Feed-->
    <link rel="alternate" type="application/atom+xml" title="Atom" href="http://psjinx.com/feed.xml" />
</head>

<body>
    <div class="row">
    <div class="large-12 columns">
        <h1>
            <a href="http://psjinx.com/">psjinx's blog</a>
        </h1>
        <span class="byline">writing my thoughts...</span>
    </div>
</div>

<div class="row">
    <div class="large-9 medium-9 columns">
        
<div class="post" itemscope itemtype="http://schema.org/Article">
    <h2 class="post-title" id="parsing-excel-workbooks-using-javascript">
    <a href="http://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/">
        <span itemprop="name">Parsing excel workbooks using Javascript</span>
    </a>
    <span itemprop="url" style="display:none"><a href="http://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/">http://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/</a>
    </span>
</h2>
<div class="meta">
    <span class="date" itemprop="datePublished">
        <img alt="Posted on" src="http://psjinx.com/images/calendar.png" />04 Jan, 2014
    </span>
    <span class="share">
        <g:plusone size="small" href="http://psjinx.comhttp://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/"></g:plusone>&nbsp;
    </span>
    <span class="tags" itemprop="keywords">
        
        <img alt="Tags" src="http://psjinx.com/images/tag.png" />
        <a href="http://psjinx.com/tags/xlsxjs">xlsxjs</a>
        
        <a href="http://psjinx.com/tags/xlsx">xlsx</a>
        
        <a href="http://psjinx.com/tags/javascript">javascript</a>
        
        <a href="http://psjinx.com/tags/excel">excel</a>
        
        <a href="http://psjinx.com/tags/workbook">workbook</a>
         
    </span>
    <span style="display:none;" itemprop="articleSection">Programming</span>
    <span itemprop="author" itemscope itemtype="http://schema.org/Person" style="display:none;">
        <span itemprop="name">Pankaj Singh</span>
        <img src="https://gravatar.com/avatar/d36fdce04734c18be6c97814ded214c2?r=x&s=200" itemprop="image" />
        <span itemprop="email">psjinx@gmail.com</span>
        <span itemprop="jobTitle">Programmer</span>
        <a href="http://psjinx.com" itemprop="url">psjinx.com</a>
    </span>
    <span itemprop="comment" itemscope itemtype="http://schema.org/UserComments" content="UserComments"><a class="comments" href="http://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/#disqus_thread" data-disqus-identifier="parsing-excel-workbooks-using-javascript">Comments</a>
        <span style="display:none;"><a itemprop="replyToUrl" href="http://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/#disqus_thread">http://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/#disqus_thread</a>
        </span>
    </span>
</div>

    <span itemprop="description" style="display:none;">A Javascript library for parsing .xlsx files. It includes sample code along with demo for integration with AngularJS. Use cases include listing sheet names for selection in a form, showing preview of selected sheet etc.</span>
    <div class='post-text' itemprop="articleBody">
         <p>Recently, I had to create a new web app, which would generate PDF reports based on data stored in excel worksheets. As usual, I used Django along with many other Python libraries for this.</p>

<p>I has following parts:</p>

<ol>
<li><strong>HTML Form -</strong> To select excel files and upload it to server</li>
<li><strong>Parsing uploaded excel file -</strong> Basic validation followed by reading data from worksheets. I used <code>xlrd</code> module from <a href="http://www.python-excel.org/">Python-Excel</a> project for this.</li>
<li><strong>Data analysis and plots -</strong> I used <a href="http://pandas.pydata.org/"><code>pandas</code></a>, Python Data Analysis Library, and <a href="http://matplotlib.org/"><code>matplotlib</code></a>, a python 2D plotting library, for this.</li>
<li><strong>PDF Generation -</strong> <a href="http://www.reportlab.com/software/rml-reference/"><code>RML</code></a> from <a href="http://www.reportlab.com/">ReportLab</a> along with awesomeness of <a href="https://docs.djangoproject.com/en/dev/ref/templates/">Django Templates</a> seems suitable for this job. I used <a href="https://github.com/zopefoundation/z3c.rml"><code>z3c.rml</code></a>, an open source implementation of <code>RML</code> standard by <a href="http://foundation.zope.org/">Zope Foundation</a>.</li>
</ol>


<p>So, everything was working like a charm, except the fact that web app was reading data from first worksheet by index whenever an excel workbook was uploaded. But, user should be able to tell which worksheet to read from, right?</p>

<p>For this, I needed to know sheet names for selected excel workbook and then show a select box to choose one sheet name. I also wanted to show data stored in that worksheet in a table, a preview.</p>

<p>After couple of Google searches for <em>"reading excel files using javascript"</em>, I landed up on homepage of <a href="http://oss.sheetjs.com/">SheetJS</a> project. They have two projects, <a href="https://github.com/SheetJS/js-xlsx"><code>js-xlsx</code></a> and <a href="https://github.com/SheetJS/js-xls"><code>js-xls</code></a>, but I did not get <strong><code>"for human beings"</code></strong> feeling from this <em>(if you have see <a href="https://gist.github.com/kennethreitz/973705">requests vs urllib2</a> then you know what I mean)</em>.</p>

<p>After 1-2 hours of walking through source code of <code>js-xlsx</code>, I ended up writing <a href="https://gist.github.com/psjinx/8002786">XLSX reader using javascript for humans</a>. Example code using this new library looks like:</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#xlsxFile&quot;</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">file</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="nx">sheets</span><span class="p">;</span>
        <span class="nx">XLSXReader</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xlsxData</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">sheets</span> <span class="o">=</span> <span class="nx">xlsxData</span><span class="p">.</span><span class="nx">sheets</span><span class="p">;</span>
            <span class="c1">// Do somehting with sheets. It&#39;s a</span>
            <span class="c1">// Javascript object with sheet names</span>
            <span class="c1">// as keys and data as value in form of 2D array</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>


<p>I have integrated this <code>XLSXReader</code> in my web app along with <a href="http://angularjs.org/">AngularJS</a>. It consists of following parts:</p>

<ol>
<li><code>XLSXReaderService</code>, an angular app service, written on top of <code>XLSXReader</code>,</li>
<li><del>a web worker for reading excel files in a separate thread</del> Firefox does not support <code>FileReader</code> api for web workers, so not using it anymore,</li>
<li>an AngularJS controller along with HTML template.</li>
</ol>


<p>Code snippet for this integration is available at <a href="https://gist.github.com/psjinx/8252417">https://gist.github.com/psjinx/8252417</a>.</p>

<h3>Demo</h3>

<p>You can see a demo of above code snippet at <a href="http://code.psjinx.com/xlsx.js/">http://code.psjinx.com/xlsx.js/</a>.</p>

<h3>Use cases for this kind of library</h3>

<ol>
<li>Showing list of sheet names to choose from</li>
<li>Preview of data stored in worksheets</li>
<li>Integration with excel like data grid editors, e.g. <a href="http://handsontable.com/">Handsontable</a></li>
<li>Send JSON data to server instead of excel files</li>
<li>Integration with <a href="http://d3js.org/">D3.js</a> and a lot more</li>
</ol>


<p><em>P.S. - I have tested everything on Google Chrome and Mozilla Firefox only. Since, this web appliaction is for internal use, I don't have to deal with browser compatibility issues. But, it should work in all browsers supported by <a href="http://lodash.com/">Lodash</a> and SheetJS.</em></p>
 
    </div>
</div>



<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = 'parsing-excel-workbooks-using-javascript';
        var disqus_title = 'Parsing excel workbooks using Javascript';
        var disqus_url = 'http://psjinx.comhttp://psjinx.com/programming/2014/01/04/parsing-excel-workbooks-using-javascript/';
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>


    </div>
    <div class="large-3 medium-3 columns">
        <h4>Follow Me</h4>
        <p>
            <i class="step fi-social-twitter size-24"></i>
            <a href="https://twitter.com/psjinx" rel="author">Twitter</a>

            <br>

            <i class="step fi-social-github size-24"></i>
            <a href="https://github.com/psjinx" rel="author">Github</a>

            <br>

            <i class="step fi-social-stackoverflow size-24"></i>
            <a href="http://stackoverflow.com/users/353550/psjinx" rel="author">Stackoverflow</a>

            <br>

            <i class="step fi-social-facebook size-24"></i>
            <a href="https://www.facebook.com/psjinx" rel="author">Facebook</a>

            <br>

            <i class="step fi-social-google-plus size-24"></i>
            <a href="https://plus.google.com/+PankajSingh-aka-psjinx/" rel="author">Google+</a>
        </p>
        <h4>Subscribe To My Feed</h4>
        <p>
            While you're here, why not add my atom feed to your <a href="http://feeds.feedburner.com/psjinx-blog">RSS reader</a> or <a href="http://feedburner.google.com/fb/a/mailverify?uri=psjinx-blog&loc=en_US">via email</a> ?
        </p>
    </div>
</div>

<div class="row">
    <div class="large-12 columns">
        <p>
            <a rel="license" href="http://creativecommons.org/licenses/by/3.0/" target="_blank">
                <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/80x15.png" />
            </a>
            Using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a>,
            <a href="http://pygments.org/" target="_blank">Pygments</a>
            | <a href="http://psjinx.com/sitemap.xml" target="_blank">Sitemap</a>
        </p>
    </div>
</div>


    <!-- Scripts-->
    <script src="http://psjinx.com/bower_components/jquery/jquery.js"></script>
    <script src="http://psjinx.com/bower_components/foundation/js/foundation.min.js"></script>
    <script type="text/javascript" src="http://psjinx.com/js/head.min.js"></script>
    <script type="text/javascript">
    // Foundation JavaScript
    // Documentation can be found at: http://foundation.zurb.com/docs
    $(document).foundation();

    //Google analytics
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-12748803-5']);
    _gaq.push(['_trackPageview']);

    //Disqus
    var disqus_shortname = 'psjinx';
    
    head.js(
        "http://www.google-analytics.com/ga.js",
        "https://apis.google.com/js/plusone.js"
    );
    
    
    head.js("http://psjinx.disqus.com/count.js");
    
    
    head.js("http://psjinx.disqus.com/embed.js");
    
    </script>
</body>

</html>
